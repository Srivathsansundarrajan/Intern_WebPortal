<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Internship Feedback</title>
    <link rel = "stylesheet" href="style.css">
    <link rel = "icon" type = "image/x-icon" href = "https://external-content.duckduckgo.com/iu/?u=https%3A%2F%2Ftse1.mm.bing.net%2Fth%3Fid%3DOIP.50EFHXxDyH-m9fIlhwNATQAAAA%26pid%3DApi&f=1&ipt=b362709b0a6bd98db2513072b81ef58951ae89b91849a46143522b324ca476a0&ipo=images">
</head>
<body>
    <div class="form">
    <form action = "https://script.google.com/macros/s/AKfycbyX7HpotPPPCih-ZBYIEl55bjel2GPP8FJnKzLb5j3VJdoNLZSElHcuNsi-vqVW9QLX/exec" method="post">
        <h3 style="text-align: center;color: #b7e7ff;">Student Internship Details Form</h3>
        
        <div class="inp_field">
            <label for="email">College Mail Id</label><br>
            <input type="email" name="email" id="email" required><br>
        </div>

        <div class="inp_field">
            <label for="reg">Register Number</label><br>
            <input type="text" name="reg" id="reg" required><br>
        </div>
        
        <div class="inp_field">
            <label for="name">Name</label><br>   
            <input type="text" name="name" id="name" required><br>
        </div>
        
        <div class="inp_field">
            <label for="title">Title</label><br> 
            <input type="text" name="title" id="title" required><br>
        </div>
        
        <div class="inp_field">
            <label for="phno">Mobile No</label><br>  
            <input type="number" name="phno" id="phno" required><br>
        </div>
        
        <div class="inp_field">
            <label for="sec">Section</label><br> 
            <input type="text" name="sec" id="sec" required><br>
        </div>
        
        <div class="inp_field">
            <label for="obtained_intership">Obtained Internship</label><br>  
            <input type="text" name="obtained_intership" id="obtained_intership" required><br>
        </div>
        
        <div class="inp_field">
            <label for="period">Period</label><br>   
            <input type="text" name="period" id="period" placeholder="e.g. 2 months" required><br>
        </div>
        
        <div class="inp_field">
            <label for="st_date">Start Date</label><br>  
            <input type="date" name="st_date" id="st_date" required><br>
        </div>
        
        <div class="inp_field">
            <label for="end_date">End Date</label><br>   
            <input type="date" name="end_date" id="end_date" required><br>
        </div>
        
        <div class="inp_field">
            <label for="cmpy_name">Company Name</label><br>  
            <input type="text" name="cmpy_name" id="cmpy_name" required><br>
        </div>
        
        <div class="inp_field">
            <label for="placement_src">Placement Source</label><br>  
            <input type="text" name="placement_src" id="placement_src" required><br>
        </div>
        
        <div class="inp_field">
            <label for="stipend">Stipend (In Rs.)</label><br>    
            <input type="text" name="stipend" id="stipend" required><br>
        </div>
    
    <div class = "inp_field">
        <label for = "intern_type" >Internship Type</label><br> 
        <select name = "intern_type" id = "intern_type" required > 

            <option value="summer Intern">Summer Internship</option>
            <option value="Winter Intern">Winter Internship</option>
            <option value="Research Intern">Research Internship</option>
        </select>

    </div>

    <div class="inp_field">
        <label for = "intern_reg" >Abroad/India</label><br> 
        <select name = "intern_reg" id = "intern_reg" required >    
        
            <option value="China">China</option>
            <option value="India">India</option>
            <option value="Japan">Japan</option>
            <option value="South Korea">South Korea</option>
            <option value="Indonesia">Indonesia</option>
            <option value="Saudi Arabia">Saudi Arabia</option>
            <option value="Iran">Iran</option>
            <option value="Pakistan">Pakistan</option>
            <option value="Thailand">Thailand</option>
            <option value="Vietnam">Vietnam</option>
            
            <option value="Nigeria">Nigeria</option>
            <option value="Egypt">Egypt</option>
            <option value="South Africa">South Africa</option>
            <option value="Kenya">Kenya</option>
            <option value="Ethiopia">Ethiopia</option>
            <option value="Ghana">Ghana</option>
            <option value="Algeria">Algeria</option>
            <option value="Morocco">Morocco</option>
            <option value="Sudan">Sudan</option>
            <option value="Uganda">Uganda</option>
            
            <option value="United States">United States</option>
            <option value="Canada">Canada</option>
            <option value="Mexico">Mexico</option>
            <option value="Cuba">Cuba</option>
            <option value="Panama">Panama</option>
            <option value="Guatemala">Guatemala</option>
            <option value="Honduras">Honduras</option>
            <option value="Costa Rica">Costa Rica</option>
            <option value="El Salvador">El Salvador</option>
            <option value="Jamaica">Jamaica</option>
            
            <option value="Brazil">Brazil</option>
            <option value="Argentina">Argentina</option>
            <option value="Colombia">Colombia</option>
            <option value="Chile">Chile</option>
            <option value="Peru">Peru</option>
            <option value="Venezuela">Venezuela</option>
            <option value="Ecuador">Ecuador</option>
            <option value="Bolivia">Bolivia</option>
            <option value="Paraguay">Paraguay</option>
            <option value="Uruguay">Uruguay</option>
            
            <option value="Germany">Germany</option>
            <option value="France">France</option>
            <option value="United Kingdom">United Kingdom</option>
            <option value="Italy">Italy</option>
            <option value="Spain">Spain</option>
            <option value="Netherlands">Netherlands</option>
            <option value="Sweden">Sweden</option>
            <option value="Switzerland">Switzerland</option>
            <option value="Poland">Poland</option>
            <option value="Norway">Norway</option>
            
            <option value="Australia">Australia</option>
            <option value="New Zealand">New Zealand</option>
            <option value="Fiji">Fiji</option>
            <option value="Papua New Guinea">Papua New Guinea</option>
            <option value="Samoa">Samoa</option>
            <option value="Tonga">Tonga</option>
            <option value="Solomon Islands">Solomon Islands</option>
            <option value="Vanuatu">Vanuatu</option>
            <option value="Kiribati">Kiribati</option>
            <option value="Micronesia">Micronesia</option>
            
        </select>

    </div>

    <hr style="height: 5px;background-color:rgb(220, 184, 240);">
    <h3 h3 style="text-align: center;color: #b7e7ff;"> Document Submission  </h3>

    <div class="inp_field">
        <label for="permission_letter">Offer Letter Submitted (Google Drive Link)</label><br>
        <input type="url" name="permission_letter" id="permission_letter" placeholder="Enter Google Drive link" required><br>
    </div>
    <br><br>
    
    <div class="inp_field">
        <label for="completion_certificate">Completion Certificate Submitted (Google Drive Link)</label><br>
        <input type="url" name="completion_certificate" id="completion_certificate" placeholder="Enter Google Drive link"><br>
    </div>
    <br><br>
    
    <div class="inp_field">
        <label for="intern_report">Internship Report Submitted (Google Drive Link)</label><br>
        <input type="url" name="intern_report" id="intern_report" placeholder="Enter Google Drive link"><br>
    </div>
    <br><br>
    
    <div class="inp_field">
        <label for="stu_feedback">Student Feedback Submitted (Google Drive Link)</label><br>
        <input type="url" name="stu_feedback" id="stu_feedback" placeholder="Enter Google Drive link"><br>
    </div>
    <br><br>
    
    <div class="inp_field">
        <label for="emp_feedback">Employee Feedback Submitted (Google Drive Link)</label><br>
        <input type="url" name="emp_feedback" id="emp_feedback" placeholder="Enter Google Drive link"><br>
    </div>
    <br><br>
    
    
    <input type = submit >

    <script>

            window.onload = function() {
            // Fetch logged-in user's email from the backend
            fetch('/getUserSession')
                .then(response => response.json())
                .then(data =>{
                    if (data.userEmail) {
                        //alert("Hello");
                        document.getElementById("email").value = data.userEmail; // Auto-fill email field
                        fetchUserDataFromGoogleSheets(data.userEmail);  // Fetch details from Google Sheets
                    } else {
                        console.log("No user logged in.");
                    }
                })
                .catch(error => console.error("Error fetching session:", error));
        };

// Function to fetch user data from Google Sheets using AppScript
function fetchUserDataFromGoogleSheets(userEmail) {
    const url = `https://script.google.com/macros/s/AKfycbyQ_pC3mL_WFlpAkPSqNthXfkZ2JnQ-tmzeZo1PcO8_NT9LDGPOQ4NYdae8eMJJJXIt/exec?email=${encodeURIComponent(userEmail)}`;

    fetch(url)
        .then(response => response.json())
        .then(data => {
            if (data.error) {
                console.log("No data found for this user.");
            } else {
                document.getElementById("reg").value = data.reg || "a";
                document.getElementById("name").value = data.name || "b";
                document.getElementById("title").value = data.title || "c";
                document.getElementById("phno").value = data.phno || "d";
                document.getElementById("sec").value = data.sec || "e";
                document.getElementById("obtained_intership").value = data.obtained_intership || "f";
                document.getElementById("period").value = data.period || "";
                document.getElementById("st_date").value = data.st_date || "";
                document.getElementById("end_date").value = data.end_date || "";
                document.getElementById("cmpy_name").value = data.cmpy_name || "";
                document.getElementById("placement_src").value = data.placement_src || "";
                document.getElementById("stipend").value = data.stipend || "";
                document.getElementById("intern_type").value = data.intern_type || "";
                document.getElementById("intern_reg").value = data.intern_reg || "";
                document.getElementById("permission_letter").value = data.permission_letter || "";
                document.getElementById("completion_certificate").value = data.completion_certificate || "";
                document.getElementById("intern_report").value = data.intern_report || "";
                document.getElementById("stu_feedback").value = data.stu_feedback || "";
                document.getElementById("emp_feedback").value = data.emp_feedback || "";
            }
        })
        .catch(error => console.error("Error fetching data from Google Sheets:", error));
}


    </script>

    
</form>
</div>
</body>
</html>